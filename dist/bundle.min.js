Vue.filter("capitalize",function(e){return e.charAt(0).toUpperCase()+e.slice(1)});var mxComprisedSelection={computed:{comprisedSelection:function(){var e,t=_.map(this.selectedComponents,"name");return _.each(this.compounds,function(n){var a=t.length,c=n.components.length,o=_.intersection(n.components,t).length;_.every([a,c],function(e){return _.isEqual(e,o)})&&(e=n.name)}),e}}},mxToggleSelected={methods:{toggleSelected:function(e){return!e.mandatory&&void(e.selected=!e.selected)}}},mxSelectedComponents={computed:{selectedComponents:function(){return _.filter(this.components,"selected")}}},mxEmitClearSelection={methods:{clearSelection:function(){this.$emit("clear-selection")}}};Vue.component("category-selection",{template:'<div>    <div class="btn-group" role="group">      <button v-for="category in categories"              v-on:click="toggleCategory(category)"              v-bind:class="{ \'btn-success\': category.selected }"              class="btn"              type="button">        <span class="glyphicon"              aria-hidden="true"              v-bind:class="{ \'glyphicon-eye-open\': category.selected, \'glyphicon-eye-close\': !category.selected }"></span>        {{ category.name | capitalize }} <span class="badge">{{ countInCategory(category.name) }}</span>      </button>    </div>  </div>',props:["categories","ingredients"],methods:{countInCategory:function(e){return _.filter(this.ingredients,{category:e}).length},toggleCategory:function(e){e.selected=!e.selected}}}),Vue.component("ingredient-search-filter",{template:'<div class="input-group">      <span class="input-group-addon">        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>      </span>      <input type="text"             class="form-control"             placeholder="Search for..."             v-model="query">      <span class="input-group-btn">        <button class="btn btn-default"                type="button"                aria-label="Close"                v-on:click="clearSearchQuery">          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>        </button>      </span>    </div>',props:["searchQuery"],data:function(){return{query:this.searchQuery}},watch:{query:function(){this.$emit("search-query-change",this.query)}},methods:{clearSearchQuery:function(){this.$emit("search-query-clear"),this.query=null}}}),Vue.component("current-price",{template:"<code>€{{total}}</code>",props:["ingredients","count"],computed:{total:function(){var e=_.filter(this.ingredients,"selected");return _.round(_.sumBy(e,"price")*this.count,2)}}}),Vue.component("ingredient-selection-list",{template:'<ul>      <li v-for="ingredient in filteredIngredients"          v-on:click="toggleSelected(ingredient)"          v-bind:class="{ \'is-selected\': ingredient.selected }"          class="ingredient-item">        {{ingredient.name}}      </li>    </ul>',props:["ingredients","searchQuery"],mixins:[mxToggleSelected],computed:{filteredIngredients:function(){if(!this.searchQuery)return this.ingredients;var e=this;return _.filter(this.ingredients,function(t){var n=_.lowerCase(t.name),a=_.lowerCase(e.searchQuery);return n.indexOf(a)!==-1})}}}),Vue.component("ingredient-selection",{template:'<div>    <ingredient-selection-list v-for="category in selectedCategories"                               v-bind:ingredients="ingredientsByCategory(category)"                               v-bind:searchQuery="query">    </ingredient-selection-list>  </div>',props:["categories","ingredients","query"],computed:{selectedCategories:function(){return _.filter(this.categories,"selected")}},methods:{ingredientsByCategory:function(e){return _.filter(this.ingredients,{category:e.name})}}}),Vue.component("selected-pizza",{template:'<div>    <h3>Ingredients</h3>    <p><span class="label label-primary">{{comprisedSelection}}</span></p>    <ul>      <li v-for="component in selectedComponents">        <span v-if="!component.mandatory" v-on:click="toggleSelected(component)" class="glyphicon glyphicon-remove" aria-hidden="true"></span>         {{component.name}}      </li>    </ul>  </div>',mixins:[mxComprisedSelection,mxSelectedComponents,mxToggleSelected],props:["components","compounds"]}),Vue.component("selected-options",{template:'<div>    <h3>Options</h3>    <ul>      <li v-for="option in selectedOptions">{{ option.name }}</li>    </ul>    <div class="input-group content-row">      <input type="text"             class="form-control"             v-model="count">      <span class="input-group-btn">      <button class="btn btn-default"              type="button"              aria-label="Sub"              v-on:click="subtract">        <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>      </button>        <button class="btn btn-default"                type="button"                aria-label="Add"                v-on:click="increment">          <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>        </button>      </span>    </div>  </div>',props:["options","count"],computed:{selectedOptions:function(){return _.filter(this.options,"selected")}},methods:{increment:function(){this.$emit("add-count-of-selection")},subtract:function(){this.$emit("sub-count-of-selection")}}}),Vue.component("clear-button",{template:'<button type="button"                     class="btn btn-default pull-right"                     v-on:click="clearSelection">    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>    Clear  </button>',mixins:[mxEmitClearSelection]}),Vue.component("done-button",{template:'<button type="button" class="btn btn-primary" v-bind:disabled="disabledButton" v-on:click="done">    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>    {{ text }}  </button>',props:["count"],computed:{disabledButton:function(){return this.count<1},text:function(){return this.count>1?"Add Pizzas":"Add Pizza"}},methods:{done:function(){this.$emit("done-current")}}}),Vue.component("accumulated-total",{template:"<code>€{{total}}</code>",props:["accumulation"],computed:{total:function(){var e=this.accumulation;return _.round(_.sumBy(e,"price"),2)}}}),Vue.component("pizza-basket",{template:'<ul>    <li v-for="(item, i) in accumulation">      <span v-on:click="remove(i)" class="glyphicon glyphicon-remove" aria-hidden="true"></span>       <span class="label label-primary">{{ item.name }}</span>       <span class="badge">{{item.count}}</span>       <span class="text-muted">€{{ item.price }}</span>    </li>  </ul>',props:["accumulation"],methods:{remove:function(e){this.$emit("remove-item",e)}}});var df_ingredients=[{selected:!0,category:"base",name:"Dough",price:1.8,mandatory:!0},{selected:!1,category:"vegetarian",name:"Cheese",price:.5},{selected:!1,category:"vegetarian",name:"Feta Cheese",price:.5},{selected:!1,category:"vegetarian",name:"Parmesan Cheese",price:.5},{selected:!1,category:"vegetarian",name:"Mozarella Cheese",price:.5},{selected:!1,category:"vegetarian",name:"Sour Cream",price:.5},{selected:!1,category:"vegetarian",name:"Egg",price:1},{selected:!0,category:"vegan",name:"Tomato Sauce",price:.1},{selected:!1,category:"vegan",name:"Bell Pepper",price:.5},{selected:!1,category:"vegan",name:"Yellow Onion",price:.3},{selected:!1,category:"vegan",name:"Red Onion",price:.3},{selected:!1,category:"vegan",name:"Garlic Sauce",price:.3},{selected:!1,category:"vegan",name:"Ruccola",price:.8},{selected:!1,category:"vegan",name:"Hot Pepper",price:.3},{selected:!1,category:"vegan",name:"Pineapple",price:.5},{selected:!1,category:"vegan",name:"Black Olives",price:.8},{selected:!1,category:"vegan",name:"Green Olives",price:.4},{selected:!1,category:"vegan",name:"Kalamata Olives",price:.4},{selected:!1,category:"vegan",name:"Broccoli",price:.5},{selected:!1,category:"vegan",name:"Spinach",price:.5},{selected:!1,category:"vegan",name:"Tomatoes",price:.3},{selected:!1,category:"vegan",name:"Beets",price:.3},{selected:!1,category:"vegan",name:"Alfalfa Sprouts",price:.4},{selected:!1,category:"vegan",name:"Artichoke Hearts",price:.4},{selected:!1,category:"vegan",name:"Avocado",price:.4},{selected:!1,category:"vegan",name:"Baby Leeks",price:.4},{selected:!1,category:"vegan",name:"Beetroot",price:.4},{selected:!1,category:"vegan",name:"Black Beans",price:.4},{selected:!1,category:"vegan",name:"Broccoli",price:.4},{selected:!1,category:"vegan",name:"Capers",price:.4},{selected:!1,category:"vegan",name:"Capicolla",price:.4},{selected:!1,category:"vegan",name:"Carrot",price:.4},{selected:!1,category:"vegan",name:"Cherry Tomatoes",price:.4},{selected:!1,category:"vegan",name:"Dried Tomatoes",price:.4},{selected:!1,category:"vegan",name:"Eggplant",price:.4},{selected:!1,category:"vegan",name:"Fungi",price:.4},{selected:!1,category:"vegan",name:"Fungi Carciofi",price:.4},{selected:!1,category:"vegan",name:"Green Pepper",price:.4},{selected:!1,category:"vegan",name:"Lettuce",price:.4},{selected:!1,category:"vegan",name:"Onions",price:.4},{selected:!1,category:"vegan",name:"Peas",price:.4},{selected:!1,category:"vegan",name:"Porcini Mushrooms",price:.4},{selected:!1,category:"vegan",name:"Portobello Mushroom",price:.4},{selected:!1,category:"vegan",name:"Red Beans",price:.4},{selected:!1,category:"vegan",name:"Red Onions",price:.4},{selected:!1,category:"vegan",name:"Red Peppers",price:.4},{selected:!1,category:"vegan",name:"Roast Cauliflower",price:.4},{selected:!1,category:"vegan",name:"Roasted Eggplant",price:.4},{selected:!1,category:"vegan",name:"Roasted Garlic",price:.4},{selected:!1,category:"vegan",name:"Roasted Peppers",price:.4},{selected:!1,category:"vegan",name:"Scallions",price:.4},{selected:!1,category:"vegan",name:"Shallots",price:.4},{selected:!1,category:"vegan",name:"Snow Peas",price:.4},{selected:!1,category:"vegan",name:"Spinach",price:.4},{selected:!1,category:"vegan",name:"Sun Dried Tomatoes",price:.4},{selected:!1,category:"vegan",name:"Sweet Corn",price:.4},{selected:!1,category:"vegan",name:"Watercress",price:.4},{selected:!1,category:"vegan",name:"Wild Mushrooms",price:.4},{selected:!1,category:"vegan",name:"Yellow Peppers",price:.4},{selected:!1,category:"vegan",name:"Yellow Squash",price:.4},{selected:!1,category:"vegan",name:"Zucchini",price:.4},{selected:!1,category:"meat",name:"Ham",price:1},{selected:!1,category:"meat",name:"Bacon",price:1},{selected:!1,category:"meat",name:"Salami",price:.8},{selected:!1,category:"meat",name:"Shrimps",price:1.2},{selected:!1,category:"meat",name:"Sausage",price:1},{selected:!1,category:"meat",name:"Chicken",price:1},{selected:!1,category:"meat",name:"Meatballs",price:1.2},{selected:!1,category:"meat",name:"Beef",price:1.2},{selected:!1,category:"meat",name:"Parma Ham",price:1.2},{selected:!1,category:"meat",name:"Turkey",price:.8},{selected:!1,category:"meat",name:"Cajun Chicken",price:1},{selected:!1,category:"meat",name:"Chicken Masala",price:1},{selected:!1,category:"meat",name:"Chicken Tikka",price:1},{selected:!1,category:"meat",name:"Chorizo",price:1},{selected:!1,category:"meat",name:"Duck",price:1},{selected:!1,category:"meat",name:"Honey Cured Ham",price:1},{selected:!1,category:"meat",name:"Meatballs",price:1},{selected:!1,category:"meat",name:"Pepperoni",price:1},{selected:!1,category:"meat",name:"Proscuitto",price:1},{selected:!1,category:"meat",name:"Serrano Ham",price:1},{selected:!1,category:"meat",name:"Venison",price:1},{selected:!1,category:"sea-food",name:"Anchovies",price:1},{selected:!1,category:"sea-food",name:"Cajun Prawn",price:1},{selected:!1,category:"sea-food",name:"Crayfish",price:1},{selected:!1,category:"sea-food",name:"Lobster",price:1},{selected:!1,category:"sea-food",name:"Oysters",price:1},{selected:!1,category:"sea-food",name:"Prawns",price:1},{selected:!1,category:"sea-food",name:"Salmon",price:1},{selected:!1,category:"sea-food",name:"Shrimps",price:1},{selected:!1,category:"sea-food",name:"Smoked Salmon",price:1},{selected:!1,category:"sea-food",name:"Squid",price:1},{selected:!1,category:"sea-food",name:"Tuna",price:1},{selected:!1,category:"sea-food",name:"Whitebait",price:1}],df_categories=[{name:"base",selected:!0},{name:"vegetarian",selected:!0},{name:"vegan",selected:!0},{name:"meat",selected:!0},{name:"sea-food",selected:!0}],df_meta=[{selected:!0,id:1,name:"Standard Flat Pizza",conflicts:2},{selected:!1,id:2,name:"Folded Pizza",conflicts:1},{selected:!1,id:3,name:"Gluten Free"},{selected:!1,id:4,name:"Family Pizza Size",conflicts:[5,6]},{selected:!0,id:5,name:"Medium Pizza Size",conflicts:[4,6]},{selected:!1,id:6,name:"Small Pizza Size",conflicts:[4,5]}],df_compounds=[{name:"Vesuvio",components:["Dough","Tomato Sauce","Cheese"]},{name:"Capriciosa",components:["Dough","Tomato Sauce","Cheese","Ham"],meta:[2]},{name:"Proscuitto e Funghi",components:["Dough","Tomato Sauce","Cheese","Proscuitto","Fungi"]}],app=new Vue({el:"#components",data:{categories:df_categories,components:df_ingredients,compounds:df_compounds,meta:df_meta,count:1,searchQuery:null,accumulation:[]},methods:{queryChange:function(e){this.searchQuery=e},queryClear:function(){this.searchQuery=null},comprisedSelection:function(){var e,t=_.map(this.selectedComponents(),"name");return _.each(this.compounds,function(n){var a=t.length,c=n.components.length,o=_.intersection(n.components,t).length;_.every([a,c],function(e){return _.isEqual(e,o)})&&(e=n.name)}),e},selectedComponents:function(){return _.filter(this.components,"selected")},composeCurrentItem:function(){var e=this.comprisedSelection(),t=this.selectedComponents(),n=_.round(_.sumBy(t,"price")*this.count,2);return{name:e||"Custom pizza",ingredients:t,price:n,count:this.count,options:this.meta}},newItem:function(){this.accumulation.push(this.composeCurrentItem()),this.clearSelection()},addCoundOfSelection:function(){this.count++},subCountOfSelection:function(){this.count--},removeItemFromAccumulation:function(e){this.accumulation.splice(e,1)},clearSelection:function(){_.each(this.components,function(e){var t=_.some(["Dough","Tomato Sauce"],function(t){return _.isEqual(e.name,t)});e.selected=t}),this.meta=[{selected:!0,id:1,name:"Standard Flat Pizza",conflicts:2},{selected:!1,id:2,name:"Folded Pizza",conflicts:1},{selected:!1,id:3,name:"Gluten Free"},{selected:!1,id:4,name:"Family Pizza Size",conflicts:[5,6]},{selected:!0,id:5,name:"Medium Pizza Size",conflicts:[4,6]},{selected:!1,id:6,name:"Small Pizza Size",conflicts:[4,5]}],this.count=1}}});